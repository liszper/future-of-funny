["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/engine_DOT_io-client/build/cjs/transports/websocket.js"],"~:js","shadow$provide.module$node_modules$engine_DOT_io_client$build$cjs$transports$websocket=function(global,require,module,exports){var Buffer=require(\"module$node_modules$buffer$index\").Buffer;\"use strict\";module=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{\"default\":mod}};Object.defineProperty(exports,\"__esModule\",{value:!0});exports.WS=void 0;global=require(\"module$node_modules$engine_DOT_io_client$build$cjs$transport\");const parseqs_js_1=require(\"module$node_modules$engine_DOT_io_client$build$cjs$contrib$parseqs\"),\nyeast_js_1=require(\"module$node_modules$engine_DOT_io_client$build$cjs$contrib$yeast\"),util_js_1=require(\"module$node_modules$engine_DOT_io_client$build$cjs$util\"),websocket_constructor_js_1=require(\"module$node_modules$engine_DOT_io_client$build$cjs$transports$websocket_constructor_browser\");module=module(require(\"module$node_modules$engine_DOT_io_client$node_modules$debug$src$browser\"));const engine_io_parser_1=require(\"module$node_modules$engine_DOT_io_parser$build$cjs$index\"),debug=(0,module.default)(\"engine.io-client:websocket\"),\nisReactNative=\"undefined\"!==typeof navigator&&\"string\"===typeof navigator.product&&\"reactnative\"===navigator.product.toLowerCase();class WS extends global.Transport{constructor(opts){super(opts);this.supportsBinary=!opts.forceBase64}get name(){return\"websocket\"}doOpen(){if(this.check()){var uri=this.uri(),protocols=this.opts.protocols,opts=isReactNative?{}:(0,util_js_1.pick)(this.opts,\"agent\",\"perMessageDeflate\",\"pfx\",\"key\",\"passphrase\",\"cert\",\"ca\",\"ciphers\",\"rejectUnauthorized\",\"localAddress\",\"protocolVersion\",\n\"origin\",\"maxPayload\",\"family\",\"checkServerIdentity\");this.opts.extraHeaders&&(opts.headers=this.opts.extraHeaders);try{this.ws=websocket_constructor_js_1.usingBrowserWebSocket&&!isReactNative?protocols?new websocket_constructor_js_1.WebSocket(uri,protocols):new websocket_constructor_js_1.WebSocket(uri):new websocket_constructor_js_1.WebSocket(uri,protocols,opts)}catch(err){return this.emitReserved(\"error\",err)}this.ws.binaryType=this.socket.binaryType||websocket_constructor_js_1.defaultBinaryType;\nthis.addEventListeners()}}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref();this.onOpen()};this.ws.onclose=closeEvent=>this.onClose({description:\"websocket connection closed\",context:closeEvent});this.ws.onmessage=ev=>this.onData(ev.data);this.ws.onerror=e=>this.onError(\"websocket error\",e)}write(packets){this.writable=!1;for(let i=0;i<packets.length;i++){const packet=packets[i],lastPacket=i===packets.length-1;(0,engine_io_parser_1.encodePacket)(packet,this.supportsBinary,\ndata=>{const opts={};websocket_constructor_js_1.usingBrowserWebSocket||(packet.options&&(opts.compress=packet.options.compress),this.opts.perMessageDeflate&&(\"string\"===typeof data?Buffer.byteLength(data):data.length)<this.opts.perMessageDeflate.threshold&&(opts.compress=!1));try{websocket_constructor_js_1.usingBrowserWebSocket?this.ws.send(data):this.ws.send(data,opts)}catch(e){debug(\"websocket closed before onclose event\")}lastPacket&&(0,websocket_constructor_js_1.nextTick)(()=>{this.writable=!0;\nthis.emitReserved(\"drain\")},this.setTimeoutFn)})}}doClose(){\"undefined\"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){var query=this.query||{};const schema=this.opts.secure?\"wss\":\"ws\";let port=\"\";this.opts.port&&(\"wss\"===schema&&443!==Number(this.opts.port)||\"ws\"===schema&&80!==Number(this.opts.port))&&(port=\":\"+this.opts.port);this.opts.timestampRequests&&(query[this.opts.timestampParam]=(0,yeast_js_1.yeast)());this.supportsBinary||(query.b64=1);query=(0,parseqs_js_1.encode)(query);const ipv6=\n-1!==this.opts.hostname.indexOf(\":\");return schema+\"://\"+(ipv6?\"[\"+this.opts.hostname+\"]\":this.opts.hostname)+port+this.opts.path+(query.length?\"?\"+query:\"\")}check(){return!!websocket_constructor_js_1.WebSocket}}exports.WS=WS}","~:source","shadow$provide[\"module$node_modules$engine_DOT_io_client$build$cjs$transports$websocket\"] = function(global,require,module,exports) {\nvar Buffer = require('buffer').Buffer;\n\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WS = void 0;\nconst transport_js_1 = require(\"../transport.js\");\nconst parseqs_js_1 = require(\"../contrib/parseqs.js\");\nconst yeast_js_1 = require(\"../contrib/yeast.js\");\nconst util_js_1 = require(\"../util.js\");\nconst websocket_constructor_js_1 = require(\"./websocket-constructor.js\");\nconst debug_1 = __importDefault(require(\"debug\")); // debug()\nconst engine_io_parser_1 = require(\"engine.io-parser\");\nconst debug = (0, debug_1.default)(\"engine.io-client:websocket\"); // debug()\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nclass WS extends transport_js_1.Transport {\n    /**\n     * WebSocket transport constructor.\n     *\n     * @api {Object} connection options\n     * @api public\n     */\n    constructor(opts) {\n        super(opts);\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Transport name.\n     *\n     * @api public\n     */\n    get name() {\n        return \"websocket\";\n    }\n    /**\n     * Opens socket.\n     *\n     * @api private\n     */\n    doOpen() {\n        if (!this.check()) {\n            // let probe timeout\n            return;\n        }\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : (0, util_js_1.pick)(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws =\n                websocket_constructor_js_1.usingBrowserWebSocket && !isReactNative\n                    ? protocols\n                        ? new websocket_constructor_js_1.WebSocket(uri, protocols)\n                        : new websocket_constructor_js_1.WebSocket(uri)\n                    : new websocket_constructor_js_1.WebSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType || websocket_constructor_js_1.defaultBinaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @api private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = closeEvent => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent\n        });\n        this.ws.onmessage = ev => this.onData(ev.data);\n        this.ws.onerror = e => this.onError(\"websocket error\", e);\n    }\n    /**\n     * Writes data to socket.\n     *\n     * @param {Array} array of packets.\n     * @api private\n     */\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            (0, engine_io_parser_1.encodePacket)(packet, this.supportsBinary, data => {\n                // always create a new object (GH-437)\n                const opts = {};\n                if (!websocket_constructor_js_1.usingBrowserWebSocket) {\n                    if (packet.options) {\n                        opts.compress = packet.options.compress;\n                    }\n                    if (this.opts.perMessageDeflate) {\n                        const len = \n                        // @ts-ignore\n                        \"string\" === typeof data ? Buffer.byteLength(data) : data.length;\n                        if (len < this.opts.perMessageDeflate.threshold) {\n                            opts.compress = false;\n                        }\n                    }\n                }\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    if (websocket_constructor_js_1.usingBrowserWebSocket) {\n                        // TypeError is thrown when passing the second argument on Safari\n                        this.ws.send(data);\n                    }\n                    else {\n                        this.ws.send(data, opts);\n                    }\n                }\n                catch (e) {\n                    debug(\"websocket closed before onclose event\");\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    (0, websocket_constructor_js_1.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    /**\n     * Closes socket.\n     *\n     * @api private\n     */\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @api private\n     */\n    uri() {\n        let query = this.query || {};\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        let port = \"\";\n        // avoid port if default for schema\n        if (this.opts.port &&\n            ((\"wss\" === schema && Number(this.opts.port) !== 443) ||\n                (\"ws\" === schema && Number(this.opts.port) !== 80))) {\n            port = \":\" + this.opts.port;\n        }\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0, yeast_js_1.yeast)();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        const encodedQuery = (0, parseqs_js_1.encode)(query);\n        const ipv6 = this.opts.hostname.indexOf(\":\") !== -1;\n        return (schema +\n            \"://\" +\n            (ipv6 ? \"[\" + this.opts.hostname + \"]\" : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \"?\" + encodedQuery : \"\"));\n    }\n    /**\n     * Feature detection for WebSocket.\n     *\n     * @return {Boolean} whether this transport is available.\n     * @api public\n     */\n    check() {\n        return !!websocket_constructor_js_1.WebSocket;\n    }\n}\nexports.WS = WS;\n\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$module$node_modules$engine_DOT_io_client$node_modules$debug$src$browser","~$shadow.js","~$module$node_modules$engine_DOT_io_client$build$cjs$transports$websocket_constructor_browser","~$module$node_modules$engine_DOT_io_client$build$cjs$contrib$yeast","~$module$node_modules$engine_DOT_io_client$build$cjs$util","~$module$node_modules$buffer$index","~$module$node_modules$engine_DOT_io_client$build$cjs$transport","~$module$node_modules$engine_DOT_io_parser$build$cjs$index","~$module$node_modules$engine_DOT_io_client$build$cjs$contrib$parseqs"]],"~:properties",["^5",["compress","onerror","onclose","binaryType","__esModule","value","context","writable","WS","onopen","b64","supportsBinary","ws","onmessage","description","headers"]],"~:compiled-at",1681642524935,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$engine_DOT_io_client$build$cjs$transports$websocket.js\",\n\"lineCount\":8,\n\"mappings\":\"AAAAA,cAAA,CAAA,uEAAA,CAA4F,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,MAAhB,CAAuBC,OAAvB,CAAgC,CACpI,IAAIC,OAASH,OAAA,CAAQ,kCAAR,CAAkBG,CAAAA,MAC/B,aACIC,OAAAA,CAAmB,IAAnBA,EAA2B,IAAKA,CAAAA,eAAhCA,EAAoD,QAAS,CAACC,GAAD,CAAM,CACnE,MAAQA,IAAD,EAAQA,GAAIC,CAAAA,UAAZ,CAA0BD,GAA1B,CAAgC,CAAE,UAAWA,GAAb,CAD4B,CAGvEE,OAAOC,CAAAA,cAAP,CAAsBN,OAAtB,CAA+B,YAA/B,CAA6C,CAAEO,MAAO,CAAA,CAAT,CAA7C,CACAP,QAAQQ,CAAAA,EAAR,CAAa,IAAK,EACZC,OAAAA,CAAiBX,OAAA,CAAQ,8DAAR,CACvB,OAAMY,aAAeZ,OAAA,CAAQ,oEAAR,CAArB;AACMa,WAAab,OAAA,CAAQ,kEAAR,CADnB,CAEMc,UAAYd,OAAA,CAAQ,yDAAR,CAFlB,CAGMe,2BAA6Bf,OAAA,CAAQ,6FAAR,CAC7BgB,OAAAA,CAAUZ,MAAA,CAAgBJ,OAAA,CAAQ,yEAAR,CAAhB,CAChB,OAAMiB,mBAAqBjB,OAAA,CAAQ,0DAAR,CAA3B,CACMkB,MAAQ,GAAIF,MAAQG,CAAAA,OAAZ,EAAqB,4BAArB,CADd;AAGMC,cAAqC,WAArCA,GAAgB,MAAOC,UAAvBD,EAC2B,QAD3BA,GACF,MAAOC,UAAUC,CAAAA,OADfF,EAEkC,aAFlCA,GAEFC,SAAUC,CAAAA,OAAQC,CAAAA,WAAlB,EACJ,MAAMb,GAAN,QAAiBC,OAAea,CAAAA,SAAhC,CAOIC,WAAW,CAACC,IAAD,CAAO,CACd,KAAA,CAAMA,IAAN,CACA,KAAKC,CAAAA,cAAL,CAAsB,CAACD,IAAKE,CAAAA,WAFd,CASd,QAAO,EAAA,CACP,MAAO,WADA,CAQXC,MAAM,EAAG,CACL,GAAK,IAAKC,CAAAA,KAAL,EAAL,CAAA,CAIA,IAAMC,IAAM,IAAKA,CAAAA,GAAL,EAAZ,CACMC,UAAY,IAAKN,CAAAA,IAAKM,CAAAA,SAD5B,CAGMN,KAAON,aAAA,CACP,EADO,CAEP,GAAIN,SAAUmB,CAAAA,IAAd,EAAoB,IAAKP,CAAAA,IAAzB,CAA+B,OAA/B,CAAwC,mBAAxC,CAA6D,KAA7D,CAAoE,KAApE,CAA2E,YAA3E,CAAyF,MAAzF,CAAiG,IAAjG,CAAuG,SAAvG,CAAkH,oBAAlH,CAAwI,cAAxI,CAAwJ,iBAAxJ;AAA2K,QAA3K,CAAqL,YAArL,CAAmM,QAAnM,CAA6M,qBAA7M,CACF,KAAKA,CAAAA,IAAKQ,CAAAA,YAAd,GACIR,IAAKS,CAAAA,OADT,CACmB,IAAKT,CAAAA,IAAKQ,CAAAA,YAD7B,CAGA,IAAI,CACA,IAAKE,CAAAA,EAAL,CACIrB,0BAA2BsB,CAAAA,qBAA3B,EAAoD,CAACjB,aAArD,CACMY,SAAA,CACI,IAAIjB,0BAA2BuB,CAAAA,SAA/B,CAAyCP,GAAzC,CAA8CC,SAA9C,CADJ,CAEI,IAAIjB,0BAA2BuB,CAAAA,SAA/B,CAAyCP,GAAzC,CAHV,CAIM,IAAIhB,0BAA2BuB,CAAAA,SAA/B,CAAyCP,GAAzC,CAA8CC,SAA9C,CAAyDN,IAAzD,CANV,CAQJ,MAAOa,GAAP,CAAY,CACR,MAAO,KAAKC,CAAAA,YAAL,CAAkB,OAAlB,CAA2BD,GAA3B,CADC,CAGZ,IAAKH,CAAAA,EAAGK,CAAAA,UAAR,CAAqB,IAAKC,CAAAA,MAAOD,CAAAA,UAAjC,EAA+C1B,0BAA2B4B,CAAAA,iBAC1E;IAAKC,CAAAA,iBAAL,EAzBA,CADK,CAiCTA,iBAAiB,EAAG,CAChB,IAAKR,CAAAA,EAAGS,CAAAA,MAAR,CAAiB,EAAAC,EAAM,CACf,IAAKpB,CAAAA,IAAKqB,CAAAA,SAAd,EACI,IAAKX,CAAAA,EAAGY,CAAAA,OAAQC,CAAAA,KAAhB,EAEJ,KAAKC,CAAAA,MAAL,EAJmB,CAMvB,KAAKd,CAAAA,EAAGe,CAAAA,OAAR,CAAkBC,UAAAC,EAAc,IAAKC,CAAAA,OAAL,CAAa,CACzCC,YAAa,6BAD4B,CAEzCC,QAASJ,UAFgC,CAAb,CAIhC,KAAKhB,CAAAA,EAAGqB,CAAAA,SAAR,CAAoBC,EAAAC,EAAM,IAAKC,CAAAA,MAAL,CAAYF,EAAGG,CAAAA,IAAf,CAC1B,KAAKzB,CAAAA,EAAG0B,CAAAA,OAAR,CAAkBC,CAAAC,EAAK,IAAKC,CAAAA,OAAL,CAAa,iBAAb,CAAgCF,CAAhC,CAZP,CAoBpBG,KAAK,CAACC,OAAD,CAAU,CACX,IAAKC,CAAAA,QAAL,CAAgB,CAAA,CAGhB,KAAK,IAAIC,EAAI,CAAb,CAAgBA,CAAhB,CAAoBF,OAAQG,CAAAA,MAA5B,CAAoCD,CAAA,EAApC,CAAyC,CACrC,MAAME,OAASJ,OAAA,CAAQE,CAAR,CAAf,CACMG,WAAaH,CAAbG,GAAmBL,OAAQG,CAAAA,MAA3BE,CAAoC,CAC1C,IAAIvD,kBAAmBwD,CAAAA,YAAvB,EAAqCF,MAArC,CAA6C,IAAK5C,CAAAA,cAAlD;AAAkEkC,IAAA,EAAQ,CAEtE,MAAMnC,KAAO,EACRX,2BAA2BsB,CAAAA,qBAAhC,GACQkC,MAAOG,CAAAA,OAGX,GAFIhD,IAAKiD,CAAAA,QAET,CAFoBJ,MAAOG,CAAAA,OAAQC,CAAAA,QAEnC,EAAI,IAAKjD,CAAAA,IAAKkD,CAAAA,iBAAd,GAGI,QAAAC,GAAa,MAAOhB,KAApBgB,CAA2B1E,MAAO2E,CAAAA,UAAP,CAAkBjB,IAAlB,CAA3BgB,CAAqDhB,IAAKS,CAAAA,MAH9D,EAIc,IAAK5C,CAAAA,IAAKkD,CAAAA,iBAAkBG,CAAAA,SAJ1C,GAKQrD,IAAKiD,CAAAA,QALb,CAKwB,CAAA,CALxB,CAJJ,CAgBA,IAAI,CACI5D,0BAA2BsB,CAAAA,qBAA/B,CAEI,IAAKD,CAAAA,EAAG4C,CAAAA,IAAR,CAAanB,IAAb,CAFJ,CAKI,IAAKzB,CAAAA,EAAG4C,CAAAA,IAAR,CAAanB,IAAb,CAAmBnC,IAAnB,CANJ,CASJ,MAAOqC,CAAP,CAAU,CACN7C,KAAA,CAAM,uCAAN,CADM,CAGNsD,UAAJ,EAGI,GAAIzD,0BAA2BkE,CAAAA,QAA/B,EAAyC,EAAA,EAAM,CAC3C,IAAKb,CAAAA,QAAL,CAAgB,CAAA,CAChB;IAAK5B,CAAAA,YAAL,CAAkB,OAAlB,CAF2C,CAA/C,CAGG,IAAK0C,CAAAA,YAHR,CAlCkE,CAA1E,CAHqC,CAJ9B,CAsDfC,OAAO,EAAG,CACiB,WAAvB,GAAI,MAAO,KAAK/C,CAAAA,EAAhB,GACI,IAAKA,CAAAA,EAAGgD,CAAAA,KAAR,EACA,CAAA,IAAKhD,CAAAA,EAAL,CAAU,IAFd,CADM,CAWVL,GAAG,EAAG,CACF,IAAIsD,MAAQ,IAAKA,CAAAA,KAAbA,EAAsB,EAC1B,OAAMC,OAAS,IAAK5D,CAAAA,IAAK6D,CAAAA,MAAV,CAAmB,KAAnB,CAA2B,IAC1C,KAAIC,KAAO,EAEP,KAAK9D,CAAAA,IAAK8D,CAAAA,IAAd,GACM,KADN,GACgBF,MADhB,EACqD,GADrD,GAC0BG,MAAA,CAAO,IAAK/D,CAAAA,IAAK8D,CAAAA,IAAjB,CAD1B,EAES,IAFT,GAEkBF,MAFlB,EAEuD,EAFvD,GAE4BG,MAAA,CAAO,IAAK/D,CAAAA,IAAK8D,CAAAA,IAAjB,CAF5B,IAGIA,IAHJ,CAGW,GAHX,CAGiB,IAAK9D,CAAAA,IAAK8D,CAAAA,IAH3B,CAMI,KAAK9D,CAAAA,IAAKgE,CAAAA,iBAAd,GACIL,KAAA,CAAM,IAAK3D,CAAAA,IAAKiE,CAAAA,cAAhB,CADJ,CACsC,GAAI9E,UAAW+E,CAAAA,KAAf,GADtC,CAIK,KAAKjE,CAAAA,cAAV,GACI0D,KAAMQ,CAAAA,GADV,CACgB,CADhB,CAGMC,MAAAA,CAAe,GAAIlF,YAAamF,CAAAA,MAAjB,EAAyBV,KAAzB,CACrB,OAAMW;AAA2C,CAAC,CAA5CA,GAAO,IAAKtE,CAAAA,IAAKuE,CAAAA,QAASC,CAAAA,OAAnB,CAA2B,GAA3B,CACb,OAAQZ,OAAR,CACI,KADJ,EAEKU,IAAA,CAAO,GAAP,CAAa,IAAKtE,CAAAA,IAAKuE,CAAAA,QAAvB,CAAkC,GAAlC,CAAwC,IAAKvE,CAAAA,IAAKuE,CAAAA,QAFvD,EAGIT,IAHJ,CAII,IAAK9D,CAAAA,IAAKyE,CAAAA,IAJd,EAKKL,KAAaxB,CAAAA,MAAb,CAAsB,GAAtB,CAA4BwB,KAA5B,CAA2C,EALhD,CApBE,CAiCNhE,KAAK,EAAG,CACJ,MAAO,CAAC,CAACf,0BAA2BuB,CAAAA,SADhC,CA/KZ,CAmLApC,OAAQQ,CAAAA,EAAR,CAAaA,EAvMuH;\",\n\"sources\":[\"node_modules/engine_DOT_io-client/build/cjs/transports/websocket.js\"],\n\"sourcesContent\":[\"shadow$provide[\\\"module$node_modules$engine_DOT_io_client$build$cjs$transports$websocket\\\"] = function(global,require,module,exports) {\\nvar Buffer = require('buffer').Buffer;\\n\\\"use strict\\\";\\nvar __importDefault = (this && this.__importDefault) || function (mod) {\\n    return (mod && mod.__esModule) ? mod : { \\\"default\\\": mod };\\n};\\nObject.defineProperty(exports, \\\"__esModule\\\", { value: true });\\nexports.WS = void 0;\\nconst transport_js_1 = require(\\\"../transport.js\\\");\\nconst parseqs_js_1 = require(\\\"../contrib/parseqs.js\\\");\\nconst yeast_js_1 = require(\\\"../contrib/yeast.js\\\");\\nconst util_js_1 = require(\\\"../util.js\\\");\\nconst websocket_constructor_js_1 = require(\\\"./websocket-constructor.js\\\");\\nconst debug_1 = __importDefault(require(\\\"debug\\\")); // debug()\\nconst engine_io_parser_1 = require(\\\"engine.io-parser\\\");\\nconst debug = (0, debug_1.default)(\\\"engine.io-client:websocket\\\"); // debug()\\n// detect ReactNative environment\\nconst isReactNative = typeof navigator !== \\\"undefined\\\" &&\\n    typeof navigator.product === \\\"string\\\" &&\\n    navigator.product.toLowerCase() === \\\"reactnative\\\";\\nclass WS extends transport_js_1.Transport {\\n    /**\\n     * WebSocket transport constructor.\\n     *\\n     * @api {Object} connection options\\n     * @api public\\n     */\\n    constructor(opts) {\\n        super(opts);\\n        this.supportsBinary = !opts.forceBase64;\\n    }\\n    /**\\n     * Transport name.\\n     *\\n     * @api public\\n     */\\n    get name() {\\n        return \\\"websocket\\\";\\n    }\\n    /**\\n     * Opens socket.\\n     *\\n     * @api private\\n     */\\n    doOpen() {\\n        if (!this.check()) {\\n            // let probe timeout\\n            return;\\n        }\\n        const uri = this.uri();\\n        const protocols = this.opts.protocols;\\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\\n        const opts = isReactNative\\n            ? {}\\n            : (0, util_js_1.pick)(this.opts, \\\"agent\\\", \\\"perMessageDeflate\\\", \\\"pfx\\\", \\\"key\\\", \\\"passphrase\\\", \\\"cert\\\", \\\"ca\\\", \\\"ciphers\\\", \\\"rejectUnauthorized\\\", \\\"localAddress\\\", \\\"protocolVersion\\\", \\\"origin\\\", \\\"maxPayload\\\", \\\"family\\\", \\\"checkServerIdentity\\\");\\n        if (this.opts.extraHeaders) {\\n            opts.headers = this.opts.extraHeaders;\\n        }\\n        try {\\n            this.ws =\\n                websocket_constructor_js_1.usingBrowserWebSocket && !isReactNative\\n                    ? protocols\\n                        ? new websocket_constructor_js_1.WebSocket(uri, protocols)\\n                        : new websocket_constructor_js_1.WebSocket(uri)\\n                    : new websocket_constructor_js_1.WebSocket(uri, protocols, opts);\\n        }\\n        catch (err) {\\n            return this.emitReserved(\\\"error\\\", err);\\n        }\\n        this.ws.binaryType = this.socket.binaryType || websocket_constructor_js_1.defaultBinaryType;\\n        this.addEventListeners();\\n    }\\n    /**\\n     * Adds event listeners to the socket\\n     *\\n     * @api private\\n     */\\n    addEventListeners() {\\n        this.ws.onopen = () => {\\n            if (this.opts.autoUnref) {\\n                this.ws._socket.unref();\\n            }\\n            this.onOpen();\\n        };\\n        this.ws.onclose = closeEvent => this.onClose({\\n            description: \\\"websocket connection closed\\\",\\n            context: closeEvent\\n        });\\n        this.ws.onmessage = ev => this.onData(ev.data);\\n        this.ws.onerror = e => this.onError(\\\"websocket error\\\", e);\\n    }\\n    /**\\n     * Writes data to socket.\\n     *\\n     * @param {Array} array of packets.\\n     * @api private\\n     */\\n    write(packets) {\\n        this.writable = false;\\n        // encodePacket efficient as it uses WS framing\\n        // no need for encodePayload\\n        for (let i = 0; i < packets.length; i++) {\\n            const packet = packets[i];\\n            const lastPacket = i === packets.length - 1;\\n            (0, engine_io_parser_1.encodePacket)(packet, this.supportsBinary, data => {\\n                // always create a new object (GH-437)\\n                const opts = {};\\n                if (!websocket_constructor_js_1.usingBrowserWebSocket) {\\n                    if (packet.options) {\\n                        opts.compress = packet.options.compress;\\n                    }\\n                    if (this.opts.perMessageDeflate) {\\n                        const len = \\n                        // @ts-ignore\\n                        \\\"string\\\" === typeof data ? Buffer.byteLength(data) : data.length;\\n                        if (len < this.opts.perMessageDeflate.threshold) {\\n                            opts.compress = false;\\n                        }\\n                    }\\n                }\\n                // Sometimes the websocket has already been closed but the browser didn't\\n                // have a chance of informing us about it yet, in that case send will\\n                // throw an error\\n                try {\\n                    if (websocket_constructor_js_1.usingBrowserWebSocket) {\\n                        // TypeError is thrown when passing the second argument on Safari\\n                        this.ws.send(data);\\n                    }\\n                    else {\\n                        this.ws.send(data, opts);\\n                    }\\n                }\\n                catch (e) {\\n                    debug(\\\"websocket closed before onclose event\\\");\\n                }\\n                if (lastPacket) {\\n                    // fake drain\\n                    // defer to next tick to allow Socket to clear writeBuffer\\n                    (0, websocket_constructor_js_1.nextTick)(() => {\\n                        this.writable = true;\\n                        this.emitReserved(\\\"drain\\\");\\n                    }, this.setTimeoutFn);\\n                }\\n            });\\n        }\\n    }\\n    /**\\n     * Closes socket.\\n     *\\n     * @api private\\n     */\\n    doClose() {\\n        if (typeof this.ws !== \\\"undefined\\\") {\\n            this.ws.close();\\n            this.ws = null;\\n        }\\n    }\\n    /**\\n     * Generates uri for connection.\\n     *\\n     * @api private\\n     */\\n    uri() {\\n        let query = this.query || {};\\n        const schema = this.opts.secure ? \\\"wss\\\" : \\\"ws\\\";\\n        let port = \\\"\\\";\\n        // avoid port if default for schema\\n        if (this.opts.port &&\\n            ((\\\"wss\\\" === schema && Number(this.opts.port) !== 443) ||\\n                (\\\"ws\\\" === schema && Number(this.opts.port) !== 80))) {\\n            port = \\\":\\\" + this.opts.port;\\n        }\\n        // append timestamp to URI\\n        if (this.opts.timestampRequests) {\\n            query[this.opts.timestampParam] = (0, yeast_js_1.yeast)();\\n        }\\n        // communicate binary support capabilities\\n        if (!this.supportsBinary) {\\n            query.b64 = 1;\\n        }\\n        const encodedQuery = (0, parseqs_js_1.encode)(query);\\n        const ipv6 = this.opts.hostname.indexOf(\\\":\\\") !== -1;\\n        return (schema +\\n            \\\"://\\\" +\\n            (ipv6 ? \\\"[\\\" + this.opts.hostname + \\\"]\\\" : this.opts.hostname) +\\n            port +\\n            this.opts.path +\\n            (encodedQuery.length ? \\\"?\\\" + encodedQuery : \\\"\\\"));\\n    }\\n    /**\\n     * Feature detection for WebSocket.\\n     *\\n     * @return {Boolean} whether this transport is available.\\n     * @api public\\n     */\\n    check() {\\n        return !!websocket_constructor_js_1.WebSocket;\\n    }\\n}\\nexports.WS = WS;\\n\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"Buffer\",\"__importDefault\",\"mod\",\"__esModule\",\"Object\",\"defineProperty\",\"value\",\"WS\",\"transport_js_1\",\"parseqs_js_1\",\"yeast_js_1\",\"util_js_1\",\"websocket_constructor_js_1\",\"debug_1\",\"engine_io_parser_1\",\"debug\",\"default\",\"isReactNative\",\"navigator\",\"product\",\"toLowerCase\",\"Transport\",\"constructor\",\"opts\",\"supportsBinary\",\"forceBase64\",\"doOpen\",\"check\",\"uri\",\"protocols\",\"pick\",\"extraHeaders\",\"headers\",\"ws\",\"usingBrowserWebSocket\",\"WebSocket\",\"err\",\"emitReserved\",\"binaryType\",\"socket\",\"defaultBinaryType\",\"addEventListeners\",\"onopen\",\"this.ws.onopen\",\"autoUnref\",\"_socket\",\"unref\",\"onOpen\",\"onclose\",\"closeEvent\",\"this.ws.onclose\",\"onClose\",\"description\",\"context\",\"onmessage\",\"ev\",\"this.ws.onmessage\",\"onData\",\"data\",\"onerror\",\"e\",\"this.ws.onerror\",\"onError\",\"write\",\"packets\",\"writable\",\"i\",\"length\",\"packet\",\"lastPacket\",\"encodePacket\",\"options\",\"compress\",\"perMessageDeflate\",\"len\",\"byteLength\",\"threshold\",\"send\",\"nextTick\",\"setTimeoutFn\",\"doClose\",\"close\",\"query\",\"schema\",\"secure\",\"port\",\"Number\",\"timestampRequests\",\"timestampParam\",\"yeast\",\"b64\",\"encodedQuery\",\"encode\",\"ipv6\",\"hostname\",\"indexOf\",\"path\"]\n}\n"]